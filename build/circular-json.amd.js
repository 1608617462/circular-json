/*! (C) WebReflection Mit Style License */
define(function(e,t){function a(e,t){var s=[],u=[e],a=[n],f;return function(e,l){return t&&(l=t(e,l)),e!==""&&(typeof l=="object"&&l?(f=o.call(u,l),f<0?(s.push((""+e).replace(i,r)),a[u.push(l)-1]=n+s.join(n)):l=a[f]):(s.pop(),typeof l=="string"&&(l=l.replace(n,r)))),l}}function f(e,t){for(var r=0,i=t.length;r<i;e=e[t[r++].replace(s,n)]);return e}function l(e){return function(t,i){var s=typeof i=="string";return s&&i.charAt(0)===n?new u(i.slice(1)):(t===""&&(i=p(i,i,{})),s&&(i=i.replace(r,n)),e?e(t,i):i)}}function c(e,t,n){for(var r=0,i=t.length;r<i;r++)t[r]=p(e,t[r],n);return t}function h(e,t,n){for(var r in t)t.hasOwnProperty(r)&&(t[r]=p(e,t[r],n));return t}function p(e,t,r){return t instanceof Array?c(e,t,r):t instanceof u?t.length?r.hasOwnProperty(t)?r[t]:r[t]=f(e,t.split(n)):e:t instanceof Object?h(e,t,r):t}function d(t,n,r){return e.stringify(t,a(t,n),r)}function v(t,n){return e.parse(t,l(n))}var n="~",r="\\x"+("0"+n.charCodeAt(0).toString(16)).slice(-2),i=new t(r,"g"),s=new t("\\"+r,"g"),o=[].indexOf||function(e){for(var t=this.length;t--&&this[t]!==e;);return t},u=String;return{stringify:d,parse:v}}(JSON,RegExp));